# Mock the atlas command outputs
env ATLAS_PATH=$MOCK_ATLAS TEST_BATCH=./migrate-lint

# Setup Azure DevOps environment  
env TF_BUILD=True
env BUILD_REPOSITORY_PROVIDER=TfsGit
env BUILD_SOURCESDIRECTORY=$WORK

# Setup the action input variables
env INPUT_CONFIG=file://testdata/config/atlas.hcl
env INPUT_ENV=test
env INPUT_DIR_NAME=pupisu
env INPUT_TAG=staging
env INPUT_VARS='{"var1":"value1","var2":"value2"}'
env INPUT_DIR=file://testdata/migrations
env INPUT_DEV_URL=sqlite://file?mode=memory
env INPUT_RUN=example

atlas-action --action=migrate/lint

-- migrate-lint/1/args --
migrate lint -w --context {"path":"file://testdata/migrations","scmType":"AZURE_DEVOPS"} --env test --config file://testdata/config/atlas.hcl --dev-url sqlite://file?mode=memory --dir file://testdata/migrations --base atlas://pupisu?tag=staging --var var1=value1 --var var2=value2 --format {{ json . }}
-- migrate-lint/1/stdout --
{"URL":"https://migration-lint-report-url"}
